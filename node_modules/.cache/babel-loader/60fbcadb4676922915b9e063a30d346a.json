{"ast":null,"code":"import _regeneratorRuntime from \"/home/marcelo/Documentos/Quenu/quenu-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/marcelo/Documentos/Quenu/quenu-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport apisauce from 'apisauce';\nimport history from './history';\nvar REDIRECT_CODES = [7, 8];\nvar REDIRECT_STATUSES = [429];\n\nvar create = function create(baseURL) {\n  // home\n  var api = apisauce.create({\n    baseURL: baseURL,\n    headers: {\n      Accept: 'application/json'\n    }\n  });\n  api.addAsyncRequestTransform(function (request) {\n    return (\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var accessToken;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                accessToken = JSON.parse(localStorage.getItem('access_token'));\n\n                if (accessToken) {\n                  request.headers['x-access-token'] = accessToken;\n                }\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))\n    );\n  });\n  api.addMonitor(function (response) {\n    if (!response.ok) {\n      /*for (let i in REDIRECT_STATUSES) {\n          if (response.status === REDIRECT_STATUSES[i]) {\n              localStorage.clear();\n              history.push('/login');\n              break;\n          }\n          if (response.status === 403) {\n              for (let j in REDIRECT_CODES) {\n                  if (response.data.code === REDIRECT_CODES[j]) {\n                      localStorage.clear();\n                      history.push('/login');\n                      break;\n                  }\n              }\n          }\n      }*/\n    }\n  });\n\n  if (true) {\n    api.addMonitor(function (response) {\n      return console.log('response: ', response);\n    });\n  } // TODO - Add error parser to transform into an specific error api\n\n  /** Conection Login API */\n\n  /**\n   *\n   * @param string email\n   * @param string password\n   */\n\n\n  var doLogin = function doLogin(email, password) {\n    return api.post('/access-token', {\n      email: email,\n      password: password\n    });\n  };\n  /**\n   *\n   * @param string token\n   */\n\n\n  var logout = function logout(token) {\n    return api.delete(\"/access-token/\".concat(token));\n  };\n  /**\n   *\n   * @param string token\n   */\n\n\n  var checkAuth = function checkAuth(token) {\n    return api.get(\"/access-token/\".concat(token));\n  };\n  /** Conection User API */\n\n  /**\n   * Creates an user\n   * @param object user\n   * @returns Promise\n   */\n\n\n  var postUserCollection = function postUserCollection(user) {\n    return api.post('/user', user);\n  };\n  /**\n   * Update an user\n   * @param int    uuid  User id\n   * @param Object user    User object\n   * @returns Promise\n   */\n\n\n  var patchUserResource = function patchUserResource(uuid, user) {\n    return api.patch(\"/user/\".concat(uuid), user);\n  };\n  /**\n   * Delete an user\n   * @param int    uuid  User id\n   * @returns Promise\n   */\n\n\n  var deleteUserResource = function deleteUserResource(uuid) {\n    return api.delete(\"/user/\".concat(uuid));\n  };\n  /**\n   * Get users\n   * @returns Promise\n   */\n\n\n  var getUserCollection = function getUserCollection(query) {\n    return api.get(\"/user\", query);\n  };\n  /**\n   * Get an user\n   * @param int    uuid  User uuid\n   * @returns Promise\n   */\n\n\n  var getUserResource = function getUserResource(uuid) {\n    return api.get(\"/user/\".concat(uuid));\n  };\n\n  return {\n    // Auth endpoint calls\n    doLogin: doLogin,\n    logout: logout,\n    checkAuth: checkAuth,\n    // User endpoint calls\n    postUserCollection: postUserCollection,\n    patchUserResource: patchUserResource,\n    deleteUserResource: deleteUserResource,\n    getUserCollection: getUserCollection,\n    getUserResource: getUserResource\n  };\n};\n\nexport default {\n  create: create\n};","map":{"version":3,"sources":["/home/marcelo/Documentos/Quenu/quenu-frontend/src/Services/Api.js"],"names":["apisauce","history","REDIRECT_CODES","REDIRECT_STATUSES","create","baseURL","api","headers","Accept","addAsyncRequestTransform","request","accessToken","JSON","parse","localStorage","getItem","addMonitor","response","ok","console","log","doLogin","email","password","post","logout","token","delete","checkAuth","get","postUserCollection","user","patchUserResource","uuid","patch","deleteUserResource","getUserCollection","query","getUserResource"],"mappings":"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","sourcesContent":["import apisauce from 'apisauce';\nimport history from './history';\n\nconst REDIRECT_CODES = [7, 8];\nconst REDIRECT_STATUSES = [429];\n\nconst create = (baseURL) => { // home\n    const api = apisauce.create({\n        baseURL,\n        headers: {\n            Accept: 'application/json',\n        }\n    });\n    api.addAsyncRequestTransform(request => async () => {\n        const accessToken = JSON.parse(localStorage.getItem('access_token'));\n        if (accessToken) {\n            request.headers['x-access-token'] = accessToken;\n        }\n    });\n\n    api.addMonitor(response => {\n        if (!response.ok) {\n            /*for (let i in REDIRECT_STATUSES) {\n                if (response.status === REDIRECT_STATUSES[i]) {\n                    localStorage.clear();\n                    history.push('/login');\n                    break;\n                }\n                if (response.status === 403) {\n                    for (let j in REDIRECT_CODES) {\n                        if (response.data.code === REDIRECT_CODES[j]) {\n                            localStorage.clear();\n                            history.push('/login');\n                            break;\n                        }\n                    }\n                }\n            }*/\n        }\n    });\n\n    if (true) {\n        api.addMonitor(response => console.log('response: ', response));\n    }\n\n    // TODO - Add error parser to transform into an specific error api\n    /** Conection Login API */\n    /**\n     *\n     * @param string email\n     * @param string password\n     */\n    const doLogin = (email, password) => {\n        return api.post('/access-token', { email, password });\n    };\n\n    /**\n     *\n     * @param string token\n     */\n    const logout = (token) => {\n        return api.delete(`/access-token/${token}`);\n    };\n\n    /**\n     *\n     * @param string token\n     */\n    const checkAuth = (token) => {\n        return api.get(`/access-token/${token}`);\n    };\n\n    /** Conection User API */\n    /**\n     * Creates an user\n     * @param object user\n     * @returns Promise\n     */\n    const postUserCollection = (user) => {\n        return api.post('/user', user);\n    };\n\n    /**\n     * Update an user\n     * @param int    uuid  User id\n     * @param Object user    User object\n     * @returns Promise\n     */\n    const patchUserResource = (uuid, user) => {\n        return api.patch(`/user/${uuid}`, user);\n    };\n\n    /**\n     * Delete an user\n     * @param int    uuid  User id\n     * @returns Promise\n     */\n    const deleteUserResource = (uuid) => {\n        return api.delete(`/user/${uuid}`);\n    };\n\n    /**\n     * Get users\n     * @returns Promise\n     */\n    const getUserCollection = (query) => {\n        return api.get(`/user`, query);\n    };\n\n    /**\n     * Get an user\n     * @param int    uuid  User uuid\n     * @returns Promise\n     */\n    const getUserResource = (uuid) => {\n        return api.get(`/user/${uuid}`);\n    };\n\n    return {\n        // Auth endpoint calls\n        doLogin,\n        logout,\n        checkAuth,\n        // User endpoint calls\n        postUserCollection,\n        patchUserResource,\n        deleteUserResource,\n        getUserCollection,\n        getUserResource\n    };\n};\n\nexport default {\n    create\n}\n"]},"metadata":{},"sourceType":"module"}